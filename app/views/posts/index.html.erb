<% content_for :title, "ちのgit" %>

<div class="container">
  <div class="row">
    <!-- サイドバー -->
    <div class="col-lg-3">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0"><i class="fas fa-tags"></i> 人気タグ</h5>
        </div>
        <div class="card-body">
          <% if @popular_tags.any? %>
            <% @popular_tags.each do |tag| %>
              <div class="d-flex justify-content-between align-items-center mb-2">
                <%= link_to tag_path(tag.name), class: "text-decoration-none" do %>
                  <span class="badge bg-secondary me-2">#<%= tag.name %></span>
                <% end %>
                <span class="text-muted small"><%= tag.posts_count %></span>
              </div>
            <% end %>
            <hr>
            <%= link_to "すべてのタグを見る", tags_path, class: "btn btn-sm btn-outline-primary w-100" %>
          <% else %>
            <p class="text-muted mb-0">まだタグがありません</p>
          <% end %>
        </div>
      </div>
    </div>

    <!-- メインコンテンツ -->
    <div class="col-lg-9">
      <div class="text-center mb-4">
        <h1 class="display-4 fw-bold text-primary">ちのgit</h1>
        <p class="lead text-muted mt-3">毎日コミットして、理想のmain branchに向かおう🚀<br>
        みんなの就活進捗をcommit logで確認しよう！</p>
      </div>

      <div class="text-center mb-4">
        <%= link_to "new commit", new_post_path, class: "btn btn-primary" %>
      </div>

      <!-- 検索フォーム（Ransack） -->
      <%= search_form_for @q, local: true, class: "mb-4" do |f| %>
        <div class="input-group">
          <%= f.search_field :content_cont, placeholder: "投稿内容で検索...", class: "form-control" %>
          <button class="btn btn-outline-secondary" type="submit">
            <i class="fas fa-search"></i> 検索
          </button>
        </div>
      <% end %>


      <div class="d-flex flex-column gap-3" id="posts">
        <% @posts.each do |post| %>
          <%= render post %>
        <% end %>
      </div>

      <div class="d-flex justify-content-center mt-4">
        <%= paginate @posts %>
      </div>
    </div>
  </div>
</div>
